## Syntax: ruleset structure

syntax =
    { { gap-separator | comment } } ,
    syntax-rule ,
    { { gap-separator | comment } , syntax-rule } ,
    { { gap-separator | comment } } ;


## Rules: definitions and alternatives

syntax-rule =
    meta-identifier ,
    { gap-separator | comment } ,
    defining-symbol ,
    { gap-separator | comment } ,
    definitions-list ,
    { gap-separator | comment } ,
    terminator-symbol ;


defining-symbol =
      "="        (* ISO *)
    | "::=" ;    (* base EBNF / BNF-style *)


definitions-list =
    single-definition ,
    { { gap-separator | comment } , definition-separator-symbol , { gap-separator | comment } , single-definition } ;


single-definition =
    syntactic-term ,
    {
        { gap-separator | comment } ,
        [ concatenate-symbol , { gap-separator | comment } ] , (* ISO requires ',', base EBNF omits it *)
        syntactic-term
    } ;


definition-separator-symbol =
      "|"        (* ISO & base EBNF *)
    | "/" ;      (* ISO optional separator *)


terminator-symbol =
      ";"        (* ISO *)
    | "." ;      (* ISO / Wirth-style *)


## Expressions: terms, factors, primaries

syntactic-term =
      syntactic-factor
    | syntactic-factor , { gap-separator | comment } , except-symbol , { gap-separator | comment } , syntactic-exception ;


syntactic-exception =
    syntactic-factor ;


syntactic-factor =
      integer , { gap-separator | comment } , repetition-symbol , { gap-separator | comment } , syntactic-primary
    | syntactic-primary ;


syntactic-primary =
      optional-sequence
    | repeated-sequence
    | grouped-sequence
    | character-range
    | meta-identifier
    | terminal-string
    | special-sequence
    | empty-sequence ;


## Grouping: blocks and options

optional-sequence =
    start-option-symbol ,
    { gap-separator | comment } ,
    definitions-list ,
    { gap-separator | comment } ,
    end-option-symbol ;


repeated-sequence =
    start-repeat-symbol ,
    { gap-separator | comment } ,
    definitions-list ,
    { gap-separator | comment } ,
    end-repeat-symbol ;


grouped-sequence =
    start-group-symbol ,
    { gap-separator | comment } ,
    definitions-list ,
    { gap-separator | comment } ,
    end-group-symbol ;


empty-sequence =
    (* empty sequence of terminal-characters *) ;


start-option-symbol  = "[" ;
end-option-symbol    = "]" ;
start-repeat-symbol  = "{" ;
end-repeat-symbol    = "}" ;
start-group-symbol   = "(" ;
end-group-symbol     = ")" ;


## Operators: core, merged, and range

repetition-symbol =
    "*" ;   (* ISO counted repetition: integer * primary *)


except-symbol =
    "-" ;   (* ISO syntactic exception A - B *)


concatenate-symbol =
    "," ;   (* ISO explicit concatenation; base also allows adjacency *)


range-operator =
    "â€¦" ;   (* extension: character range operator using U+2026 ellipsis *)


operators =
      repetition-symbol
    | except-symbol
    | concatenate-symbol
    | definition-separator-symbol
    | defining-symbol
    | terminator-symbol
    | range-operator ;


## Ranges: character-range primary

character-range =
    terminal-string ,
    { gap-separator | comment } ,
    range-operator ,
    { gap-separator | comment } ,
    terminal-string ;


## Terminals: strings and special sequences

terminal-string =
      first-quote-symbol ,
      first-terminal-character ,
      { first-terminal-character } ,
      first-quote-symbol
    | second-quote-symbol ,
      second-terminal-character ,
      { second-terminal-character } ,
      second-quote-symbol ;


first-terminal-character =
    terminal-character - first-quote-symbol ;


second-terminal-character =
    terminal-character - second-quote-symbol ;


special-sequence =
    special-sequence-symbol ,
    { special-sequence-character } ,
    special-sequence-symbol ;


special-sequence-character =
    terminal-character - special-sequence-symbol ;


first-quote-symbol   = "'" ;
second-quote-symbol  = "\"" ;
special-sequence-symbol = "?" ;


## Layout: gaps and comments



gap-separator =
      " "
    | "\t"
    | line-terminator ;

line-terminator =
      "\n"
    | "\r"
    | "\r\n" ;


comment =
    start-comment-symbol ,
    { comment-character } ,
    end-comment-symbol ;


start-comment-symbol = "(*" ;
end-comment-symbol   = "*)" ;


comment-character =
    terminal-character - end-comment-symbol ;


## Lexical: identifiers, integers, characters

meta-identifier =
    meta-identifier-character ,
    { meta-identifier-character } ;


meta-identifier-character =
      letter
    | decimal-digit
    | "_" ;  (* common extension from base EBNF practice *)


integer =
    decimal-digit ,
    { decimal-digit } ;


decimal-digit =
      "0" | "1" | "2" | "3" | "4"
    | "5" | "6" | "7" | "8" | "9" ;


letter =
      "A" | "B" | "C" | "D" | "E" | "F" | "G" | "H" | "I" | "J"
    | "K" | "L" | "M" | "N" | "O" | "P" | "Q" | "R" | "S" | "T"
    | "U" | "V" | "W" | "X" | "Y" | "Z"
    | "a" | "b" | "c" | "d" | "e" | "f" | "g" | "h" | "i" | "j"
    | "k" | "l" | "m" | "n" | "o" | "p" | "q" | "r" | "s" | "t"
    | "u" | "v" | "w" | "x" | "y" | "z" ;


terminal-character =
    ? any character in the chosen character set ? ;
